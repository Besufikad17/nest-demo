generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String              @id @default(uuid())
  firstName      String
  lastName       String
  email          String?             @unique
  phoneNumber    String?             @unique
  passwordHash   String
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  lastLogin      DateTime?
  isActive       Boolean             @default(false)
  accountStatus  USER_ACCOUNT_STATUS @default(INACTIVE)
  twoStepEnabled Boolean             @default(false)
  OTP            OTP[]
}

model OTP {
  id         String         @id @default(uuid())
  userId     String?        @unique
  identifier OTP_IDENTIFIER
  activity   OTP_ACTIVITY
  status     OTP_STATUS     @default(PENDING)
  value      String         @unique
  otpCode    String         @unique
  createdAt  DateTime       @default(now())
  attempts   Int            @default(5)
  User       User?          @relation(fields: [userId], references: [id])
}

enum USER_ACCOUNT_STATUS {
  ACTIVE
  INACTIVE
  SUSPENDED
  DELETED
}

enum OTP_IDENTIFIER {
  EMAIL
  PHONE
}

enum OTP_ACTIVITY {
  ACCOUNT_VERIFICATION
  ACCOUNT_RECOVERY
  TWO_FACTOR_AUTHENTICATION
  PASSWORD_RESET
}

enum OTP_STATUS {
  PENDING
  VERIFIED
  EXPIRED
}
